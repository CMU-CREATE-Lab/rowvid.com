<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="">

    <title>SochiVid</title>

    <!-- Bootstrap core CSS -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <style>
        body {
          padding-top: 50px;
        }
        .starter-template {
          padding: 40px 15px;
          text-align: center;
        }
    </style>

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project name</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container">

      <div class="starter-template">
        <h1>Bootstrap starter template</h1>
        <p class="lead">Use this document as a way to quickly start any new project.<br> All you get is this text and a mostly barebones HTML document.</p>

<!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
        <div id="player"></div>
        <p>
            <input id="share-url" type="url" readonly="readonly" size="100" onclick="this.select();">
        </p>
        
        <script>
            sochivid = {}

            // 2. This code loads the IFrame Player API code asynchronously.
            var tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            var firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

            // 3. This function creates an <iframe> (and YouTube player)
            //    after the API code downloads.
            var player;
            function onYouTubeIframeAPIReady() {
                videoProps = getVideoPropsFromURL()
                sochivid.id = videoProps.id

                player = new YT.Player('player', {
                    height: '390',
                    width: '640',
                    videoId: videoProps.id,
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

                setInterval(updateUI, 10);
            }

            // 4. The API will call this function when the video player is ready.
            function onPlayerReady(event) {
                event.target.playVideo();
            }

            // 5. The API calls this function when the player's state changes.
            function onPlayerStateChange(event) {

            }

            function getVideoPropsFromURL() {
                videoProps = {
                    "id": "Mbc7oynavxw",
                    "time": 0,
                    "speed": 1
                }

                if (window.location.href.indexOf("?") != -1) {
                    args = window.location.href.split("?")[1]
                    args = args.split("&")
                    for (var i in args) {
                        keyValuePair = args[i]
                        key = keyValuePair.split("=")[0]
                        value = keyValuePair.split("=")[1]
                        switch(key) {
                            case "v":
                                videoProps.id = value;
                                break;
                            case "t":
                                videoProps.time = value;
                                break;
                            case "s":
                                videoProps.speed = value;
                                break;
                        }
                    }
                }

                return videoProps
            }

            function updateUI() {
                videoID = 
                shareURL = "http://sochivid.com/?v="
                    + sochivid.id
                    + "&t="
                    + preciseRound(player.getCurrentTime(), 2)
                    + "&s="
                    + player.getPlaybackRate()

                    document.getElementById("share-url").value = shareURL
                    document.getElementById("share-url").select()
            }

            function preciseRound(num, decimals) {
               return Math.round(num * Math.pow(10, decimals)) / Math.pow(10, decimals);
            }
        </script>


      </div>



    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/jquery/jquery.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>